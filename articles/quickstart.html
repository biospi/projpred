<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>projpred Quick Start • projpred</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="projpred Quick Start">
<meta property="og:description" content="projpred">
<meta property="og:image" content="https://mc-stan.org/projpred/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">projpred</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/cmdstanr">cmdstanr</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="https://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="https://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstantools">rstantools</a>
    </li>
    <li>
      <a href="https://mc-stan.org/posterior">posterior</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://mc-stan.org">Stan</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/projpred/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="quickstart_files/header-attrs-2.4/header-attrs.js"></script><script src="quickstart_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>projpred Quick Start</h1>
            
            <h4 class="date">2020-10-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stan-dev/projpred/blob/master/vignettes/quickstart.Rmd"><code>vignettes/quickstart.Rmd</code></a></small>
      <div class="hidden name"><code>quickstart.Rmd</code></div>

    </div>

    
    
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{projpred Quick Start}
\usepackage[utf8](inputenc)
-->
<p>This vignette shows how to use the main functionalities of the <code>projpred</code>-package, which implements the projective variable selection (Goutis and Robert, 1998; Dupuis and Robert, 2003) for generalized linear models. The package is compatible with <code>rstanarm</code> but also other reference models could be used (see section Custom reference models). The methods implemented in the package are described in detail in Piironen et al. (2020) and evaluated in comparison to many other methods in Piironen and Vehtari (2017a).</p>
<div id="gaussian-example" class="section level2">
<h2 class="hasAnchor">
<a href="#gaussian-example" class="anchor"></a>Gaussian example</h2>
<p>Load the necessary packages. If the sampling takes more than 10 seconds and multiple cores are available, uncomment the line setting <code>mc.cores</code> to set the number of cores used (this is commented out as the sampling in the example is fast and to avoid possible problems when building the vignette along the package installation in special environments such as computing clusters).</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms">brms</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/projpred/">projpred</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot">bayesplot</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#options(mc.cores = parallel::detectCores())</span></pre></div>
<p>The package contains a simple Gaussian example dataset accessible with the <code>data</code>-command. This dataset is one of the example cases from the <code>glmnet</code>-package. The following loads a dataframe <code>df_gaussian</code> with the predictor matrix <code>x</code> and the corresponding targets <code>y</code> into the workspace.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">'df_gaussian'</span>, package <span class="op">=</span> <span class="st">'projpred'</span><span class="op">)</span></pre></div>
<p>We first construct a model with all the variables and regularized horseshoe prior (Piironen and Vehtari, 2017c) on the regression coefficients. This gives us the full Bayesian solution to the problem. We specify the prior on the number of relevant variables using the approch by Piironen and Vehtari (2017b,c). The prior for the global shrinkage parameter is defined based on the prior on the number of relevant variables.</p>
<p>Before building the model we call <code>break_up_matrix_term</code>. This is a convenience function to automatically split matrix variables in linear terms. For example, in <code>y ~ x</code>, <code>x</code> can be a matrix. If this function is not used, <code>projpred</code> considers <code>x</code> to be jointly included or excluded in the variable selection.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="va">split_structure</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/break_up_matrix_term.html">break_up_matrix_term</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">df_gaussian</span><span class="op">)</span>
<span class="va">df_gaussian</span> <span class="op">&lt;-</span> <span class="va">split_structure</span><span class="op">$</span><span class="va">data</span>
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">split_structure</span><span class="op">$</span><span class="va">formula</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="va">df_gaussian</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df_gaussian</span><span class="op">)</span> <span class="co"># 100</span>
<span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df_gaussian</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># 20</span>
<span class="va">p0</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="co"># prior guess for the number of relevant variables</span>
<span class="va">tau0</span> <span class="op">&lt;-</span> <span class="va">p0</span><span class="op">/</span><span class="op">(</span><span class="va">D</span><span class="op">-</span><span class="va">p0</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="co"># scale for tau (notice that stan_glm will automatically scale this by sigma)</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html">brm</a></span><span class="op">(</span><span class="va">formula</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>, data<span class="op">=</span><span class="va">df_gaussian</span>,
           prior<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html">prior</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/brms/man/horseshoe.html">horseshoe</a></span><span class="op">(</span>scale_global <span class="op">=</span> <span class="va">tau0</span>, scale_slab <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, class<span class="op">=</span><span class="va">b</span><span class="op">)</span>,
           <span class="co">## To make this vignette build fast, we use only 2 chains and</span>
           <span class="co">## 500 iterations. In practice, at least 4 chains should be </span>
           <span class="co">## used and 2000 iterations might be required for reliable</span>
           <span class="co">## inference.</span>
           seed<span class="op">=</span><span class="fl">1</span>, chains<span class="op">=</span><span class="fl">2</span>, iter<span class="op">=</span><span class="fl">500</span><span class="op">)</span></pre></div>
<p>Thanks to its general interface, <code>projpred</code> can be applied to a very wide set of models. To achieve so, we internally define the following set of functions: - Divergence minimizer for the projection, which in this case it simply corresponds to a maximum likelihood estimator. - Prediction function for the projections. - Prediction function for the reference model that outputs the linear predictor. - Function to fetch data from the original dataset.</p>
<p>For most models, <code>projpred</code> is able to generate these itself without any user input more than the reference model object. Nonetheless, for custom or not supported models, the user can provide those themself (more details in the documentation about reference models).</p>
<!-- ```{r, results='hide', messages=FALSE, warning=FALSE} -->
<!-- ref_predfun <- function(fit, newdata=NULL) -->
<!--   t(posterior_linpred(fit, newdata = newdata)) -->
<!-- proj_predfun <- function(fit, newdata=NULL) { -->
<!--   newdata <- as.data.frame(fetch_data(xnew=newdata)) -->
<!--   predict(fit, newdata = newdata) -->
<!-- } -->
<!-- mle <- function(form, dat) -->
<!--   lm(form, data = dat) -->
<!-- fetch_data <- function(obs=NULL, xnew=NULL) { -->
<!--   if (is.null(obs)) -->
<!--     if (is.null(xnew)) -->
<!--       return(d) -->
<!--     else -->
<!--       return(xnew) -->
<!--   else if (is.null(xnew)) -->
<!--     return(d[obs, ]) -->
<!--   else -->
<!--     return(xnew[obs, ]) -->
<!-- } -->
<!-- ``` -->
<!-- The first function, `ref_predfun`, is the prediction function for the reference model, so we use `posterior_linpred` from `rstanarm`. -->
<!-- For each of the submodels we use `proj_predfun`, which uses `lme4` `predict` function for linear models. -->
<!-- To fit the projections we use `lm`. -->
<!-- Finally, the `fetch_data` function that simply extracts a set of data points from the dataset, that will be used during the cross validation stage. -->
<!-- The `fetch_data` function needs to handle the different data structures needed in different contexts inside `projpred`. -->
<p>Next we construct the reference model structure <code>refmodel</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="va">refmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get-refmodel.html">get_refmodel</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></pre></div>
<p>The function <code>cv_varsel</code> runs a cross-validated variable selection, and returns an object that contains the relevant information about the procedure, such as the ordering of the variables. The search heuristic can be specified by the keyword <code>method</code>. For a simple linear model, the fastest method is to use L1–search, that is the default option. For a more accurate result we recommend running forward search.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="va">vs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv_varsel.html">cv_varsel</a></span><span class="op">(</span><span class="va">refmodel</span>, method <span class="op">=</span> <span class="st">"forward"</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="../reference/solution_terms.html">solution_terms</a></span><span class="op">(</span><span class="va">vs</span><span class="op">)</span> <span class="co"># selection order of the variables</span></pre></div>
<pre><code> [1] "x1"  "x14" "x20" "x5"  "x3"  "x6"  "x8"  "x11" "x10" "x7"  "x15" "x13"
[13] "x12" "x4"  "x18" "x16" "x2"  "x17" "x9" </code></pre>
<p>We plot some statistics computed on the training data, such as the sum of log predictive densities (ELPD) and root mean squared error (RMSE) as the function of number of variables added. By default, the statistics are shown on absolute scale, but with <code>deltas=T</code> the plot shows results relative to the full model.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">vs</span>, stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'elpd'</span>, <span class="st">'rmse'</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="quickstart_files/figure-html/unnamed-chunk-8-1.png" width="750" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="co"># plot the validation results, this time relative to the full model</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">vs</span>, stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'elpd'</span>, <span class="st">'rmse'</span><span class="op">)</span>, deltas <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></pre></div>
<p><img src="quickstart_files/figure-html/unnamed-chunk-9-1.png" width="750" style="display: block; margin: auto;"></p>
<p>We perform the projection for a submodel of desired size using the function <code>project</code>. The projection can also be coerced to a matrix with draws of the selected variables and sigma. The draws can be visualized with, for example, the <code>mcmc_areas</code> function in the <code>bayesplot</code> package. Below we compare how the projection affects the three most relevant variables.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
 <span class="co"># Visualise the three most relevant variables in the full model --&gt;</span>
 <span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html">mcmc_areas</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">refmodel</span><span class="op">$</span><span class="va">fit</span><span class="op">)</span>,
            pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"b_Intercept"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"b_"</span>, <span class="fu"><a href="../reference/solution_terms.html">solution_terms</a></span><span class="op">(</span><span class="va">vs</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,
                     <span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="quickstart_files/figure-html/unnamed-chunk-10-1.png" width="900" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="co"># Visualise the projected three most relevant variables</span>
<span class="va">proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">vs</span>, nterms <span class="op">=</span> <span class="fl">3</span>, ns <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>
<span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html">mcmc_areas</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">proj</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="quickstart_files/figure-html/unnamed-chunk-11-1.png" width="900" style="display: block; margin: auto;"></p>
<p>We make predictions with the projected submodels. For point estimates we can use method <code>proj_linpred</code>. Test inputs can be provided using the keyword <code>newdata</code>. If also the test targets <code>ynew</code> are provided in <code>newdata</code>, then the function evaluates the log predictive density at these points. For instance, the following computes the mean of the predictive distribution and evaluates the log density at the training points using the 6 most relevant variables.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/proj-pred.html">proj_linpred</a></span><span class="op">(</span><span class="va">vs</span>, newdata <span class="op">=</span> <span class="va">df_gaussian</span>, nterms <span class="op">=</span> <span class="fl">6</span>, integrated <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></pre></div>
<p>Visualize the predictions</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pred</span><span class="op">$</span><span class="va">pred</span>,y <span class="op">=</span> <span class="va">df_gaussian</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"prediction"</span>, y <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span></pre></div>
<p><img src="quickstart_files/figure-html/unnamed-chunk-13-1.png" width="750" style="display: block; margin: auto;"></p>
<p>We also obtain draws from the projected predictive distribution. Here’s an example prediction for a random data point using 6 variables (the observed value is marked by the red line)</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="va">subset</span> <span class="op">&lt;-</span> <span class="va">df_gaussian</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">y_subset</span> <span class="op">&lt;-</span> <span class="va">subset</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="va">y1_rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/proj-pred.html">proj_predict</a></span><span class="op">(</span><span class="va">vs</span>, newdata <span class="op">=</span> <span class="va">subset</span>, nterms <span class="op">=</span> <span class="fl">6</span>, seed <span class="op">=</span> <span class="fl">7560</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">y1_rep</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">y_subset</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"y1_rep"</span><span class="op">)</span></pre></div>
<p><img src="quickstart_files/figure-html/unnamed-chunk-14-1.png" width="750" style="display: block; margin: auto;"></p>
<p>Forward search finds a sparser model with comparable performance to Lasso but starts overfitting when more features are added.</p>
<div id="references" class="section level3">
<h3 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h3>
<p>Carvalho, C.M., Polson, N.G., Scott, J.G. (2010). The horseshoe estimator for sparse signals. <em>Biometrika</em> 97(2):465–480.</p>
<p>Dupuis, J. A. and Robert, C. P. (2003). Variable selection in qualitative models via an entropic explanatory power. <em>Journal of Statistical Planning and Inference</em>, 111(1-2):77–94.</p>
<p>Goutis, C. and Robert, C. P. (1998). Model choice in generalised linear models: a Bayesian approach via Kullback–Leibler projections. <em>Biometrika</em>, 85(1):29–37.</p>
<p>Piironen, Juho and Vehtari, Aki (2017a). Comparison of Bayesian predictive methods for model selection. <em>Statistics and Computing</em> 27(3):711-735. DOI 10.1007/s11222-016-9649-y. <a href="https://link.springer.com/article/10.1007/s11222-016-9649-y">Online</a></p>
<p>Piironen, Juho and Vehtari, Aki (2017b). On the Hyperprior Choice for the Global Shrinkage Parameter in the Horseshoe Prior. In <em>Proceedings of the 20th International Conference on Artificial Intelligence and Statistics (AISTATS)</em>, PMLR 54:905-913, 2017. <a href="http://proceedings.mlr.press/v54/piironen17a.html">Online</a></p>
<p>Piironen, Juho and Vehtari, Aki (2017c). Sparsity information and regularization in the horseshoe and other shrinkage priors. <em>Electronic Journal of Statistics</em>, 11(2): 5018–5051. <a href="https://projecteuclid.org/euclid.ejs/1513306866#info">Online</a></p>
<p>Piironen, Juho, Paasiniemi, Markus and Vehtari, Aki (2020). Projective Inference in High-dimensional Problems: Prediction and Feature Selection. <a href="https://projecteuclid.org/euclid.ejs/1589335310">Online</a></p>
<p>Tibshirani, Robert (1996). Regression shrinkage and selection via the Lasso. <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, 58(1):267–288, 1996.</p>
<p>Tran, M.N., Nott, D.J., Leng, C. (2012): The predictive Lasso. <em>Statistics and Computing</em> 22(5):1069-1084.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Juho Piironen, Markus Paasiniemi, Alejandro Catalina, Aki Vehtari.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
