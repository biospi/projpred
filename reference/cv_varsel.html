<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cross-validated variable selection (varsel) — cv_varsel • projpred</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Cross-validated variable selection (varsel) — cv_varsel" />
<meta property="og:description" content="Perform cross-validation for the projective variable selection for a
generalized linear model or generalized lienar and additive multilevel
models." />
<meta property="og:image" content="https://mc-stan.org/projpred/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">projpred</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/cmdstanr">cmdstanr</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="https://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="https://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstantools">rstantools</a>
    </li>
    <li>
      <a href="https://mc-stan.org/posterior">posterior</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://mc-stan.org">Stan</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/projpred/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cross-validated variable selection (varsel)</h1>
    <small class="dont-index">Source: <a href='https://github.com/stan-dev/projpred/blob/master/R/cv_varsel.R'><code>R/cv_varsel.R</code></a></small>
    <div class="hidden name"><code>cv_varsel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform cross-validation for the projective variable selection for a
generalized linear model or generalized lienar and additive multilevel
models.</p>
    </div>

    <pre class="usage"><span class='fu'>cv_varsel</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for default</span>
<span class='fu'>cv_varsel</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for refmodel</span>
<span class='fu'>cv_varsel</span><span class='op'>(</span>
  <span class='va'>object</span>,
  method <span class='op'>=</span> <span class='cn'>NULL</span>,
  cv_method <span class='op'>=</span> <span class='cn'>NULL</span>,
  ndraws <span class='op'>=</span> <span class='cn'>NULL</span>,
  nclusters <span class='op'>=</span> <span class='cn'>NULL</span>,
  ndraws_pred <span class='op'>=</span> <span class='cn'>NULL</span>,
  nclusters_pred <span class='op'>=</span> <span class='cn'>NULL</span>,
  cv_search <span class='op'>=</span> <span class='cn'>TRUE</span>,
  nterms_max <span class='op'>=</span> <span class='cn'>NULL</span>,
  intercept <span class='op'>=</span> <span class='cn'>NULL</span>,
  penalty <span class='op'>=</span> <span class='cn'>NULL</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  nloo <span class='op'>=</span> <span class='cn'>NULL</span>,
  K <span class='op'>=</span> <span class='cn'>NULL</span>,
  lambda_min_ratio <span class='op'>=</span> <span class='fl'>1e-05</span>,
  nlambda <span class='op'>=</span> <span class='fl'>150</span>,
  thresh <span class='op'>=</span> <span class='fl'>1e-06</span>,
  regul <span class='op'>=</span> <span class='fl'>1e-04</span>,
  validate_search <span class='op'>=</span> <span class='cn'>TRUE</span>,
  seed <span class='op'>=</span> <span class='cn'>NULL</span>,
  search_terms <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>Same as in <a href='varsel.html'>varsel</a>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to be passed to the
<code>get_refmodel</code>-function.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Same as in <a href='varsel.html'>varsel</a>.</p></td>
    </tr>
    <tr>
      <th>cv_method</th>
      <td><p>The cross-validation method, either 'LOO' or 'kfold'.
Default is 'LOO'.</p></td>
    </tr>
    <tr>
      <th>ndraws</th>
      <td><p>Number of posterior draws used for selection. Ignored if
nclusters is provided or if method='L1'.</p></td>
    </tr>
    <tr>
      <th>nclusters</th>
      <td><p>Number of clusters used for selection. Default is 1 and
ignored if method='L1' (L1-search uses always one cluster).</p></td>
    </tr>
    <tr>
      <th>ndraws_pred</th>
      <td><p>Number of samples used for prediction (after selection).
Ignored if nclusters_pred is given.</p></td>
    </tr>
    <tr>
      <th>nclusters_pred</th>
      <td><p>Number of clusters used for prediction (after
selection). Default is 5.</p></td>
    </tr>
    <tr>
      <th>cv_search</th>
      <td><p>Same as in <a href='varsel.html'>varsel</a>.</p></td>
    </tr>
    <tr>
      <th>nterms_max</th>
      <td><p>Same as in <a href='varsel.html'>varsel</a>.</p></td>
    </tr>
    <tr>
      <th>intercept</th>
      <td><p>Same as in <a href='varsel.html'>varsel</a>.</p></td>
    </tr>
    <tr>
      <th>penalty</th>
      <td><p>Same as in <a href='varsel.html'>varsel</a>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Whether to print out some information during the validation,
Default is TRUE.</p></td>
    </tr>
    <tr>
      <th>nloo</th>
      <td><p>Number of observations used to compute the LOO validation
(anything between 1 and the total number of observations). Smaller values
lead to faster computation but higher uncertainty (larger errorbars) in the
accuracy estimation. Default is to use all observations, but for faster
experimentation, one can set this to a small value such as 100. Only
applicable if <code>cv_method = 'LOO'</code>.</p></td>
    </tr>
    <tr>
      <th>K</th>
      <td><p>Number of folds in the K-fold cross validation. Default is 5 for
genuine reference models and 10 for datafits (that is, for penalized
maximum likelihood estimation).</p></td>
    </tr>
    <tr>
      <th>lambda_min_ratio</th>
      <td><p>Same as in <a href='varsel.html'>varsel</a>.</p></td>
    </tr>
    <tr>
      <th>nlambda</th>
      <td><p>Same as in <a href='varsel.html'>varsel</a>.</p></td>
    </tr>
    <tr>
      <th>thresh</th>
      <td><p>Same as in <a href='varsel.html'>varsel</a>.</p></td>
    </tr>
    <tr>
      <th>regul</th>
      <td><p>Amount of regularization in the projection. Usually there is no
need for regularization, but sometimes for some models the projection can
be ill-behaved and we need to add some regularization to avoid numerical
problems.</p></td>
    </tr>
    <tr>
      <th>validate_search</th>
      <td><p>Whether to cross-validate also the selection process,
that is, whether to perform selection separately for each fold. Default is
TRUE and we strongly recommend not setting this to FALSE, because this is
known to bias the accuracy estimates for the selected submodels. However,
setting this to FALSE can sometimes be useful because comparing the results
to the case where this parameter is TRUE gives idea how strongly the
feature selection is (over)fitted to the data (the difference corresponds
to the search degrees of freedom or the effective number of parameters
introduced by the selectin process).</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>Random seed used in the subsampling LOO. By default uses a fixed
seed.</p></td>
    </tr>
    <tr>
      <th>search_terms</th>
      <td><p>User defined list of terms to consider for selection.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of type <code>vsel</code> that contains information about the
  feature selection. The fields are not meant to be accessed directly by the
  user but instead via the helper functions (see the vignettes or type
  ?projpred to see the main functions in the package.)</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>'rstanarm'</span>, quietly<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'>### Usage with stanreg objects</span>
  <span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>30</span>
  <span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fl'>5</span>
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>*</span><span class='va'>d</span><span class='op'>)</span>, nrow<span class='op'>=</span><span class='va'>n</span><span class='op'>)</span>
  <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>x</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>0.5</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>
  <span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span><span class='op'>)</span>
  <span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'>rstanarm</span><span class='fu'>::</span><span class='fu'>stan_glm</span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>X1</span> <span class='op'>+</span> <span class='va'>X2</span> <span class='op'>+</span> <span class='va'>X3</span> <span class='op'>+</span> <span class='va'>X4</span> <span class='op'>+</span> <span class='va'>X5</span>, <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>gaussian</a></span><span class='op'>(</span><span class='op'>)</span>,
     data<span class='op'>=</span><span class='va'>data</span>, chains<span class='op'>=</span><span class='fl'>2</span>, iter<span class='op'>=</span><span class='fl'>500</span><span class='op'>)</span>
  <span class='va'>cvs</span> <span class='op'>&lt;-</span> <span class='fu'>cv_varsel</span><span class='op'>(</span><span class='va'>fit</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>cvs</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; 
#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
#&gt; Chain 1: 
#&gt; Chain 1: Gradient evaluation took 0.000106 seconds
#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.06 seconds.
#&gt; Chain 1: Adjust your expectations accordingly!
#&gt; Chain 1: 
#&gt; Chain 1: 
#&gt; Chain 1: Iteration:   1 / 500 [  0%]  (Warmup)
#&gt; Chain 1: Iteration:  50 / 500 [ 10%]  (Warmup)
#&gt; Chain 1: Iteration: 100 / 500 [ 20%]  (Warmup)
#&gt; Chain 1: Iteration: 150 / 500 [ 30%]  (Warmup)
#&gt; Chain 1: Iteration: 200 / 500 [ 40%]  (Warmup)
#&gt; Chain 1: Iteration: 250 / 500 [ 50%]  (Warmup)
#&gt; Chain 1: Iteration: 251 / 500 [ 50%]  (Sampling)
#&gt; Chain 1: Iteration: 300 / 500 [ 60%]  (Sampling)
#&gt; Chain 1: Iteration: 350 / 500 [ 70%]  (Sampling)
#&gt; Chain 1: Iteration: 400 / 500 [ 80%]  (Sampling)
#&gt; Chain 1: Iteration: 450 / 500 [ 90%]  (Sampling)
#&gt; Chain 1: Iteration: 500 / 500 [100%]  (Sampling)
#&gt; Chain 1: 
#&gt; Chain 1:  Elapsed Time: 0.011664 seconds (Warm-up)
#&gt; Chain 1:                0.010852 seconds (Sampling)
#&gt; Chain 1:                0.022516 seconds (Total)
#&gt; Chain 1: 
#&gt; 
#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
#&gt; Chain 2: 
#&gt; Chain 2: Gradient evaluation took 9e-06 seconds
#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.09 seconds.
#&gt; Chain 2: Adjust your expectations accordingly!
#&gt; Chain 2: 
#&gt; Chain 2: 
#&gt; Chain 2: Iteration:   1 / 500 [  0%]  (Warmup)
#&gt; Chain 2: Iteration:  50 / 500 [ 10%]  (Warmup)
#&gt; Chain 2: Iteration: 100 / 500 [ 20%]  (Warmup)
#&gt; Chain 2: Iteration: 150 / 500 [ 30%]  (Warmup)
#&gt; Chain 2: Iteration: 200 / 500 [ 40%]  (Warmup)
#&gt; Chain 2: Iteration: 250 / 500 [ 50%]  (Warmup)
#&gt; Chain 2: Iteration: 251 / 500 [ 50%]  (Sampling)
#&gt; Chain 2: Iteration: 300 / 500 [ 60%]  (Sampling)
#&gt; Chain 2: Iteration: 350 / 500 [ 70%]  (Sampling)
#&gt; Chain 2: Iteration: 400 / 500 [ 80%]  (Sampling)
#&gt; Chain 2: Iteration: 450 / 500 [ 90%]  (Sampling)
#&gt; Chain 2: Iteration: 500 / 500 [100%]  (Sampling)
#&gt; Chain 2: 
#&gt; Chain 2:  Elapsed Time: 0.0108 seconds (Warm-up)
#&gt; Chain 2:                0.008535 seconds (Sampling)
#&gt; Chain 2:                0.019335 seconds (Total)
#&gt; Chain 2: </div><div class='output co'>#&gt; <span class='warning'>Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
#&gt; <span class='warning'>Running the chains for more iterations may help. See</span>
#&gt; <span class='warning'>http://mc-stan.org/misc/warnings.html#bulk-ess</span></div><div class='output co'>#&gt; <span class='warning'>Warning: K provided, but cv_method is LOO.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Some Pareto k diagnostic values are slightly high. See help('pareto-k-diagnostic') for details.</span></div><div class='output co'>#&gt; [1] "Computing LOOs..."
#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |==                                                                    |   3%  |                                                                              |=====                                                                 |   7%  |                                                                              |=======                                                               |  10%  |                                                                              |=========                                                             |  13%  |                                                                              |============                                                          |  17%  |                                                                              |==============                                                        |  20%  |                                                                              |================                                                      |  23%  |                                                                              |===================                                                   |  27%  |                                                                              |=====================                                                 |  30%  |                                                                              |=======================                                               |  33%  |                                                                              |==========================                                            |  37%  |                                                                              |============================                                          |  40%  |                                                                              |==============================                                        |  43%  |                                                                              |=================================                                     |  47%  |                                                                              |===================================                                   |  50%  |                                                                              |=====================================                                 |  53%  |                                                                              |========================================                              |  57%  |                                                                              |==========================================                            |  60%  |                                                                              |============================================                          |  63%  |                                                                              |===============================================                       |  67%  |                                                                              |=================================================                     |  70%  |                                                                              |===================================================                   |  73%  |                                                                              |======================================================                |  77%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  83%  |                                                                              |=============================================================         |  87%  |                                                                              |===============================================================       |  90%  |                                                                              |=================================================================     |  93%  |                                                                              |====================================================================  |  97%  |                                                                              |======================================================================| 100%
#&gt; [1] "Performing the selection using all the data.."
#&gt; [1] "Done."</div><div class='img'><img src='cv_varsel-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Juho Piironen, Markus Paasiniemi, Alejandro Catalina, Aki Vehtari.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


